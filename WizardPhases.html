<script>
/**
 * ===================================================================
 * WIZARD PHASES - Contenu de toutes les phases du wizard
 * ===================================================================
 */

// ===================================================================
// PHASE 1 : INITIALISATION
// ===================================================================
function loadPhase1Content() {
  const container = document.getElementById('phase-1-content');

  // V√©rifier s'il existe une session sauvegard√©e ou des mod√®les
  google.script.run
    .withSuccessHandler((modeles) => {
      renderPhase1(container, modeles);
    })
    .withFailureHandler(() => {
      renderPhase1(container, []);
    })
    .listerModelesConfig();
}

function renderPhase1(container, modeles) {
  let html = '';

  // Section : Charger un mod√®le
  if (modeles && modeles.length > 0) {
    html += `
      <div class="alert alert-info">
        <span class="material-icons">lightbulb</span>
        <div>
          <strong>Mod√®les disponibles</strong>
          <p>Vous pouvez charger une configuration existante pour gagner du temps.</p>
        </div>
      </div>

      <div class="config-card">
        <div class="config-card-title">
          <span class="material-icons">folder_open</span>
          Charger un mod√®le de configuration
        </div>

        <div class="form-row">
          <label>Mod√®le :</label>
          <select id="modele-select">
            <option value="">-- Nouvelle configuration --</option>
            ${modeles.map(m => `<option value="${m.nom}">${m.nom} (${new Date(m.dateCreation).toLocaleDateString()})</option>`).join('')}
          </select>
        </div>

        <button class="btn btn-secondary" onclick="chargerModele()">
          <span class="material-icons">download</span>
          Charger ce mod√®le
        </button>
      </div>
    `;
  }

  // Section : Configuration de base
  html += `
    <div class="config-card">
      <div class="config-card-title">
        <span class="material-icons">school</span>
        Param√®tres de base
      </div>

      <div class="form-row">
        <label>Niveau scolaire : <span style="color:red;">*</span></label>
        <select id="niveau-select">
          <option value="">-- S√©lectionner --</option>
          <option value="6¬∞">6¬∞</option>
          <option value="5¬∞">5¬∞</option>
          <option value="4¬∞">4¬∞</option>
          <option value="3¬∞">3¬∞</option>
        </select>
      </div>
    </div>

    <div class="config-card">
      <div class="config-card-title">
        <span class="material-icons">domain</span>
        Structure des classes
      </div>

      <div class="form-row">
        <label>Nombre de classes SOURCES : <span style="color:red;">*</span></label>
        <input type="number" id="nb-sources" min="1" max="20" value="9" />
      </div>

      <div class="form-row">
        <label id="label-sources">√©coles primaires</label>
      </div>

      <div class="form-row">
        <label>Nombre de classes DESTINATIONS : <span style="color:red;">*</span></label>
        <input type="number" id="nb-destinations" min="1" max="15" value="5" />
      </div>

      <div class="form-row">
        <label id="label-destinations">classes de 6¬∞ √† cr√©er</label>
      </div>
    </div>

    <div class="config-card">
      <div class="config-card-title">
        <span class="material-icons">translate</span>
        LV2 disponibles
      </div>

      <div id="lv2-tags" class="tag-list"></div>

      <div class="form-row" style="margin-top: 16px;">
        <input type="text" id="lv2-input" placeholder="Ajouter une LV2 (ex: ESP, ITA, ALL...)" />
        <button class="btn btn-secondary" onclick="ajouterLV2()">
          <span class="material-icons">add</span>
          Ajouter
        </button>
      </div>

      <div style="margin-top: 12px; font-size: 13px; color: #666;">
        üí° Exemples : ESP (Espagnol), ITA (Italien), ALL (Allemand), CHI (Chinois)
      </div>
    </div>

    <div class="config-card">
      <div class="config-card-title">
        <span class="material-icons">library_books</span>
        Options disponibles
      </div>

      <div id="opt-tags" class="tag-list"></div>

      <div class="form-row" style="margin-top: 16px;">
        <input type="text" id="opt-input" placeholder="Ajouter une option (ex: LATIN, GREC...)" />
        <button class="btn btn-secondary" onclick="ajouterOPT()">
          <span class="material-icons">add</span>
          Ajouter
        </button>
      </div>

      <div style="margin-top: 12px; font-size: 13px; color: #666;">
        üí° Exemples : LATIN, GREC, CHAV (Chavagnes), LLCA, SPORT
      </div>
    </div>

    <div class="config-card" style="background: #f0f9ff; border: 1px solid #1976d2;">
      <div class="config-card-title">
        <span class="material-icons">info</span>
        Cette √©tape va cr√©er
      </div>

      <ul style="margin-left: 20px; line-height: 1.8;">
        <li><span id="summary-sources">9</span> onglets sources (ECOLE1, ECOLE2... ECOLE9)</li>
        <li>Onglet CONSOLIDATION</li>
        <li>Onglet _STRUCTURE</li>
        <li>Onglet _CONFIG</li>
      </ul>
    </div>

    <div class="form-row" style="margin-top: 20px;">
      <label></label>
      <button class="btn btn-secondary" onclick="sauvegarderCommeModele()">
        <span class="material-icons">save</span>
        Sauvegarder comme mod√®le
      </button>
    </div>
  `;

  container.innerHTML = html;

  // Initialiser les LV2 et OPT par d√©faut
  phase1_lv2Options = ['ESP', 'ITA', 'ALL', 'CHI'];
  phase1_optOptions = ['CHAV', 'LATIN', 'GREC'];
  updateLV2Tags();
  updateOPTTags();

  // Event listeners
  document.getElementById('niveau-select').addEventListener('change', updateLabelsFromNiveau);
  document.getElementById('nb-sources').addEventListener('input', updateSummary);
  document.getElementById('nb-destinations').addEventListener('input', updateSummary);
}

// Variables globales pour Phase 1
let phase1_lv2Options = [];
let phase1_optOptions = [];

function updateLabelsFromNiveau() {
  const niveau = document.getElementById('niveau-select').value;
  const labelSources = document.getElementById('label-sources');
  const labelDest = document.getElementById('label-destinations');

  if (niveau === '6¬∞') {
    labelSources.textContent = '√©coles primaires';
    labelDest.textContent = 'classes de 6¬∞ √† cr√©er';
  } else {
    const niveauPrecedent = {'5¬∞': '6¬∞', '4¬∞': '5¬∞', '3¬∞': '4¬∞'}[niveau] || 'niveau pr√©c√©dent';
    labelSources.textContent = `classes de ${niveauPrecedent}`;
    labelDest.textContent = `classes de ${niveau} √† cr√©er`;
  }
}

function updateSummary() {
  const nbSources = document.getElementById('nb-sources').value || 0;
  document.getElementById('summary-sources').textContent = nbSources;
}

function ajouterLV2() {
  const input = document.getElementById('lv2-input');
  const value = input.value.trim().toUpperCase();

  if (!value) return;

  if (!phase1_lv2Options.includes(value)) {
    phase1_lv2Options.push(value);
    updateLV2Tags();
  }

  input.value = '';
}

function supprimerLV2(lv2) {
  phase1_lv2Options = phase1_lv2Options.filter(item => item !== lv2);
  updateLV2Tags();
}

function updateLV2Tags() {
  const container = document.getElementById('lv2-tags');
  if (!container) return;

  if (phase1_lv2Options.length === 0) {
    container.innerHTML = '<p style="color: #999; font-style: italic;">Aucune LV2 ajout√©e</p>';
    return;
  }

  container.innerHTML = phase1_lv2Options.map(lv2 => `
    <div class="tag">
      ${lv2}
      <span class="material-icons remove-tag" onclick="supprimerLV2('${lv2}')" style="font-size: 16px;">close</span>
    </div>
  `).join('');
}

function ajouterOPT() {
  const input = document.getElementById('opt-input');
  const value = input.value.trim().toUpperCase();

  if (!value) return;

  if (!phase1_optOptions.includes(value)) {
    phase1_optOptions.push(value);
    updateOPTTags();
  }

  input.value = '';
}

function supprimerOPT(opt) {
  phase1_optOptions = phase1_optOptions.filter(item => item !== opt);
  updateOPTTags();
}

function updateOPTTags() {
  const container = document.getElementById('opt-tags');
  if (!container) return;

  if (phase1_optOptions.length === 0) {
    container.innerHTML = '<p style="color: #999; font-style: italic;">Aucune option ajout√©e</p>';
    return;
  }

  container.innerHTML = phase1_optOptions.map(opt => `
    <div class="tag" style="background: #f3e5f5; color: #7b1fa2;">
      ${opt}
      <span class="material-icons remove-tag" onclick="supprimerOPT('${opt}')" style="font-size: 16px;">close</span>
    </div>
  `).join('');
}

function getLV2Options() {
  return phase1_lv2Options;
}

function getOptOptions() {
  return phase1_optOptions;
}

function chargerModele() {
  const select = document.getElementById('modele-select');
  const nomModele = select.value;

  if (!nomModele) {
    showAlert('warning', 'Veuillez s√©lectionner un mod√®le');
    return;
  }

  showLoading('Chargement du mod√®le...');

  google.script.run
    .withSuccessHandler((config) => {
      hideLoading();

      // Remplir les champs
      if (config.niveau) document.getElementById('niveau-select').value = config.niveau;
      if (config.nbSources) document.getElementById('nb-sources').value = config.nbSources;
      if (config.nbDestinations) document.getElementById('nb-destinations').value = config.nbDestinations;

      if (config.lv2Options) {
        phase1_lv2Options = config.lv2Options;
        updateLV2Tags();
      }

      if (config.optOptions) {
        phase1_optOptions = config.optOptions;
        updateOPTTags();
      }

      updateLabelsFromNiveau();
      updateSummary();

      showAlert('success', `Mod√®le "${nomModele}" charg√© avec succ√®s`);
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur : ${error.message}`);
    })
    .chargerModeleConfig(nomModele);
}

function sauvegarderCommeModele() {
  const nom = prompt('Nom du mod√®le :');

  if (!nom) return;

  const config = {
    niveau: document.getElementById('niveau-select').value,
    nbSources: parseInt(document.getElementById('nb-sources').value),
    nbDestinations: parseInt(document.getElementById('nb-destinations').value),
    lv2Options: phase1_lv2Options,
    optOptions: phase1_optOptions
  };

  showLoading('Sauvegarde du mod√®le...');

  google.script.run
    .withSuccessHandler(() => {
      hideLoading();
      showAlert('success', `Mod√®le "${nom}" sauvegard√© avec succ√®s`);
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur : ${error.message}`);
    })
    .sauvegarderModeleConfig(nom, config);
}

function validatePhase1() {
  const niveau = document.getElementById('niveau-select')?.value;
  const nbSources = parseInt(document.getElementById('nb-sources')?.value);
  const nbDest = parseInt(document.getElementById('nb-destinations')?.value);

  if (!niveau) {
    showAlert('error', 'Veuillez s√©lectionner un niveau scolaire');
    return false;
  }

  if (!nbSources || nbSources < 1) {
    showAlert('error', 'Le nombre de classes sources doit √™tre au moins 1');
    return false;
  }

  if (!nbDest || nbDest < 1) {
    showAlert('error', 'Le nombre de classes destinations doit √™tre au moins 1');
    return false;
  }

  if (phase1_lv2Options.length === 0) {
    showAlert('warning', 'Aucune LV2 configur√©e. √ätes-vous s√ªr ?');
    // On ne bloque pas, c'est juste un warning
  }

  // Tout est OK, lancer l'initialisation
  showLoading('Initialisation du syst√®me...');

  google.script.run
    .withSuccessHandler((result) => {
      hideLoading();

      // Sauvegarder dans l'√©tat
      wizardState.data.niveau = niveau;
      wizardState.data.nbSources = nbSources;
      wizardState.data.nbDestinations = nbDest;
      wizardState.data.lv2Options = phase1_lv2Options;
      wizardState.data.optOptions = phase1_optOptions;

      showAlert('success', 'Syst√®me initialis√© avec succ√®s !');

      // Passer √† la phase suivante apr√®s 1 seconde
      setTimeout(() => goToPhase(2), 1000);
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur lors de l'initialisation : ${error.message}`);
    })
    .wizard_initialiserSysteme(niveau, nbSources, nbDest, phase1_lv2Options, phase1_optOptions);

  // Bloquer la validation le temps de l'initialisation
  return false;
}

// ===================================================================
// PHASE 2 : IMPORT & PR√âPARATION
// ===================================================================
function loadPhase2Content() {
  const container = document.getElementById('phase-2-content');

  let html = `
    <div class="alert alert-info">
      <span class="material-icons">info</span>
      <div>
        <strong>5 √©tapes √† suivre</strong>
        <p>Import des donn√©es, g√©n√©ration automatique, validation et consolidation</p>
      </div>
    </div>

    <!-- √âTAPE 1 : IMPORT -->
    <div class="config-card">
      <div class="section-header">
        √âTAPE 1 : Import des donn√©es
      </div>

      <p style="margin-bottom: 16px;">Comment voulez-vous ajouter les √©l√®ves ?</p>

      <div class="form-row">
        <label>
          <input type="radio" name="import-method" value="manuel" checked /> Saisie manuelle
        </label>
      </div>

      <div class="form-row">
        <label>
          <input type="radio" name="import-method" value="csv" /> Import CSV
        </label>
      </div>

      <div id="csv-import-zone" style="display: none; margin-top: 16px; padding: 16px; background: #f5f5f5; border-radius: 6px;">
        <div class="form-row">
          <label>Classe cible :</label>
          <select id="csv-target-sheet">
            <option value="">-- S√©lectionner --</option>
          </select>
        </div>

        <div class="form-row">
          <label>Fichier CSV :</label>
          <input type="file" id="csv-file" accept=".csv" />
        </div>

        <button class="btn btn-primary" onclick="importerCSV()">
          <span class="material-icons">upload_file</span>
          Importer
        </button>
      </div>

      <div style="margin-top: 16px;">
        <button class="btn btn-secondary" onclick="ouvrirOngletsSourcesPourSaisie()">
          <span class="material-icons">open_in_new</span>
          Ouvrir les onglets sources
        </button>
      </div>
    </div>

    <!-- √âTAPE 2 : G√âN√âRATION -->
    <div class="config-card">
      <div class="section-header">
        √âTAPE 2 : G√©n√©ration automatique
      </div>

      <p style="margin-bottom: 16px;">
        ‚úÖ Colonnes g√©n√©r√©es automatiquement :
      </p>

      <ul style="margin-left: 20px; line-height: 1.8;">
        <li><strong>NOM & PRENOM</strong> ‚Üí Concat√©nation automatique</li>
        <li><strong>ID_ELEVE</strong> ‚Üí G√©n√©ration unique (ECOLE1001, ECOLE1002...)</li>
      </ul>

      <p style="margin-top: 12px; color: #666; font-size: 13px;">
        üí° Les colonnes NOM, PRENOM et ID_ELEVE seront masqu√©es apr√®s g√©n√©ration
      </p>

      <button class="btn btn-success" onclick="genererNomPrenomID()" style="margin-top: 16px;">
        <span class="material-icons">auto_fix_high</span>
        G√©n√©rer maintenant
      </button>
    </div>

    <!-- √âTAPE 3 : LISTES D√âROULANTES -->
    <div class="config-card">
      <div class="section-header">
        √âTAPE 3 : Listes d√©roulantes
      </div>

      <p style="margin-bottom: 16px;">
        Les listes d√©roulantes suivantes seront cr√©√©es :
      </p>

      <ul style="margin-left: 20px; line-height: 1.8;">
        <li><strong>SEXE</strong> ‚Üí M / F</li>
        <li><strong>LV2</strong> ‚Üí ${wizardState.data.lv2Options.join(' / ')}</li>
        <li><strong>OPT</strong> ‚Üí ${wizardState.data.optOptions.join(' / ')}</li>
        <li><strong>COM / TRA / PART / ABS</strong> ‚Üí 1 / 2 / 3 / 4</li>
        <li><strong>DISPO</strong> ‚Üí ULIS / GEVASCO / PAP / PPRE...</li>
      </ul>

      <button class="btn btn-success" onclick="appliquerListesDeroulantes()" style="margin-top: 16px;">
        <span class="material-icons">check_box</span>
        Appliquer les listes
      </button>
    </div>

    <!-- √âTAPE 4 : VALIDATION -->
    <div class="config-card">
      <div class="section-header">
        √âTAPE 4 : Validation
      </div>

      <div id="validation-results" style="margin-bottom: 16px;">
        <p style="color: #999; font-style: italic;">Cliquez sur "Valider" pour v√©rifier les donn√©es</p>
      </div>

      <button class="btn btn-primary" onclick="validerDonnees()">
        <span class="material-icons">check_circle</span>
        Valider les donn√©es
      </button>
    </div>

    <!-- √âTAPE 5 : CONSOLIDATION -->
    <div class="config-card">
      <div class="section-header">
        √âTAPE 5 : Consolidation
      </div>

      <p style="margin-bottom: 16px;">
        Fusion de toutes les donn√©es dans l'onglet CONSOLIDATION
      </p>

      <div id="consolidation-results" style="margin-bottom: 16px;">
        <p style="color: #999; font-style: italic;">La consolidation sera effectu√©e apr√®s validation</p>
      </div>

      <button class="btn btn-success" onclick="consoliderDonnees()" id="btn-consolider" disabled>
        <span class="material-icons">merge</span>
        Consolider maintenant
      </button>
    </div>
  `;

  container.innerHTML = html;

  // Charger les onglets sources
  chargerOngletsSourcesPourCSV();

  // Event listener pour le choix d'import
  document.querySelectorAll('input[name="import-method"]').forEach(radio => {
    radio.addEventListener('change', (e) => {
      const csvZone = document.getElementById('csv-import-zone');
      csvZone.style.display = e.target.value === 'csv' ? 'block' : 'none';
    });
  });
}

function chargerOngletsSourcesPourCSV() {
  google.script.run
    .withSuccessHandler((info) => {
      if (info && info.sources) {
        const select = document.getElementById('csv-target-sheet');
        select.innerHTML = '<option value="">-- S√©lectionner --</option>' +
          info.sources.map(s => `<option value="${s}">${s}</option>`).join('');
      }
    })
    .wizard_getStructureInfo();
}

function ouvrirOngletsSourcesPourSaisie() {
  showAlert('info', 'Vous pouvez maintenant saisir les donn√©es dans les onglets sources. Revenez ici une fois termin√©.');
  google.script.host.close();
}

function importerCSV() {
  const fileInput = document.getElementById('csv-file');
  const targetSheet = document.getElementById('csv-target-sheet').value;

  if (!targetSheet) {
    showAlert('error', 'Veuillez s√©lectionner une classe cible');
    return;
  }

  if (!fileInput.files || fileInput.files.length === 0) {
    showAlert('error', 'Veuillez s√©lectionner un fichier CSV');
    return;
  }

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function(e) {
    const csvContent = e.target.result;

    showLoading('Import du fichier CSV...');

    google.script.run
      .withSuccessHandler((result) => {
        hideLoading();
        showAlert('success', `${result.lignesImportees} lignes import√©es dans ${targetSheet}`);
        fileInput.value = '';
      })
      .withFailureHandler((error) => {
        hideLoading();
        showAlert('error', `Erreur : ${error.message}`);
      })
      .importCSVVersOnglet(csvContent, targetSheet);
  };

  reader.readAsText(file);
}

function genererNomPrenomID() {
  showLoading('G√©n√©ration NOM_PRENOM et ID_ELEVE...');

  google.script.run
    .withSuccessHandler(() => {
      hideLoading();
      showAlert('success', 'NOM_PRENOM et ID_ELEVE g√©n√©r√©s avec succ√®s !');
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur : ${error.message}`);
    })
    .wizard_genererNomPrenomEtID();
}

function appliquerListesDeroulantes() {
  showLoading('Application des listes d√©roulantes...');

  google.script.run
    .withSuccessHandler(() => {
      hideLoading();
      showAlert('success', 'Listes d√©roulantes appliqu√©es avec succ√®s !');
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur : ${error.message}`);
    })
    .wizard_ajouterListesDeroulantes();
}

function validerDonnees() {
  showLoading('Validation des donn√©es...');

  google.script.run
    .withSuccessHandler((result) => {
      hideLoading();

      const container = document.getElementById('validation-results');

      if (result.hasErrors) {
        container.innerHTML = `
          <div class="alert alert-error">
            <span class="material-icons">error</span>
            <div>${result.message}</div>
          </div>
        `;
        document.getElementById('btn-consolider').disabled = true;
      } else {
        container.innerHTML = `
          <div class="alert alert-success">
            <span class="material-icons">check_circle</span>
            <div>${result.message}</div>
          </div>
        `;
        document.getElementById('btn-consolider').disabled = false;
        wizardState.data.dataValidated = true;
      }
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur : ${error.message}`);
    })
    .wizard_verifierDonnees();
}

function consoliderDonnees() {
  showLoading('Consolidation des donn√©es...');

  google.script.run
    .withSuccessHandler((result) => {
      hideLoading();

      const container = document.getElementById('consolidation-results');
      container.innerHTML = `
        <div class="alert alert-success">
          <span class="material-icons">check_circle</span>
          <div>${result.message}</div>
        </div>
      `;

      wizardState.data.consolidated = true;
      showAlert('success', 'Donn√©es consolid√©es ! Vous pouvez passer √† l\'√©tape suivante.');
    })
    .withFailureHandler((error) => {
      hideLoading();
      showAlert('error', `Erreur : ${error.message}`);
    })
    .wizard_consoliderDonnees();
}

function validatePhase2() {
  return wizardState.data.consolidated === true;
}

// ===================================================================
// PHASES 3-6 : PLACEHOLDERS (√† impl√©menter)
// ===================================================================
function loadPhase3Content() {
  const container = document.getElementById('phase-3-content');
  container.innerHTML = `
    <div class="alert alert-info">
      <span class="material-icons">construction</span>
      <div>
        <strong>Phase 3 : Configuration</strong>
        <p>Cette phase sera impl√©ment√©e avec le mapping classes, quotas LV2/Options et coefficients de pond√©ration.</p>
        <p>Pour l'instant, vous pouvez utiliser l'interface ConfigurationComplete.html existante.</p>
      </div>
    </div>

    <button class="btn btn-primary" onclick="ouvrirConfigurationComplete()">
      <span class="material-icons">settings</span>
      Ouvrir Configuration Compl√®te
    </button>
  `;
}

function loadPhase4Content() {
  const container = document.getElementById('phase-4-content');
  container.innerHTML = `
    <div class="alert alert-info">
      <span class="material-icons">construction</span>
      <div>
        <strong>Phase 4 : Ex√©cution</strong>
        <p>Cette phase sera impl√©ment√©e avec le pipeline LEGACY et suivi en temps r√©el.</p>
      </div>
    </div>
  `;
}

function loadPhase5Content() {
  const container = document.getElementById('phase-5-content');
  container.innerHTML = `
    <div class="alert alert-info">
      <span class="material-icons">construction</span>
      <div>
        <strong>Phase 5 : Validation & Rapport</strong>
        <p>Cette phase affichera le rapport d√©taill√© avec alertes et statistiques.</p>
      </div>
    </div>
  `;
}

function loadPhase6Content() {
  const container = document.getElementById('phase-6-content');
  container.innerHTML = `
    <div class="alert alert-info">
      <span class="material-icons">construction</span>
      <div>
        <strong>Phase 6 : Finalisation</strong>
        <p>Cette phase permettra d'acc√©der aux swaps manuels, finaliser TEST‚ÜíDEF et g√©n√©rer les exports.</p>
      </div>
    </div>

    <div class="config-card">
      <button class="btn btn-success" onclick="ouvrirInterfaceV2()">
        <span class="material-icons">swap_horiz</span>
        Ouvrir Interface V2 (Swaps Manuels)
      </button>
    </div>
  `;
}

function validatePhase3() {
  // Pour l'instant, on accepte de passer
  wizardState.data.mappingComplete = true;
  wizardState.data.quotasComplete = true;
  wizardState.data.coefficientsComplete = true;
  return true;
}

function validatePhase4() {
  // Pour l'instant, on accepte de passer
  wizardState.data.pipelineExecuted = true;
  return true;
}

function validatePhase5() {
  return true;
}

function validatePhase6() {
  return true;
}

function ouvrirConfigurationComplete() {
  // Fermer le wizard et ouvrir ConfigurationComplete
  google.script.host.close();
  // L'utilisateur devra manuellement ouvrir ConfigurationComplete depuis le menu
  showAlert('info', 'Utilisez le menu Console > Configuration Compl√®te');
}

function ouvrirInterfaceV2() {
  google.script.host.close();
  showAlert('info', 'Utilisez le menu Interface V2 pour les swaps manuels');
}
</script>
